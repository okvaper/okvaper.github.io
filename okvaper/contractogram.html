<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>ConnectWithContractors Beta</title><!--alternate available domains: proposo.com , proposalfy.com-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="">
		<meta name="author" content="">
		<!-- Le styles -->
		<link href="assets/css/bootstrap.css" rel="stylesheet">
		<link href="assets/css/bootstrap-responsive.css" rel="stylesheet">
		<link href="assets/css/docs.css" rel="stylesheet">
		<link href="assets/js/prettify.css" rel="stylesheet">
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
	</head>
	<body data-target=".bs-docs-sidebar">
		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </a>
					<div>
						<a class="brand navbar-fixed-top pull-left" href="#">ConnectWithContractors</a>
					</div>
					<div class="nav-collapse collapse">
						<form class="navbar-form pull-right">
							<input class="span2" type="text" placeholder="Email">
							<input class="span2" type="password" placeholder="Password">
							<button type="submit" class="btn">
								Sign in
							</button>
						</form>
						<ul class="nav pull-right">
							<li class="active">
								<a href="#">Home</a>
							</li>
							<li>
								<a href="#about">About</a>
							</li>
							<li>
								<a href="mailto:connectwithcontractors@gmail.com">Contact</a>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		<div class="container">
			<p></p>
			<!-- Docs nav
			================================================== -->
			<div class="row">
				<div class="bs-docs-sidebar">
					<ul class="inline nav nav-list" id="inputs"></ul>
				</div>
				<div class="span9" id="proposal"></div>
			</div>
		</div>
		<!-- Footer
		================================================== -->
		<section id="about">
			<footer class="footer">
				<div class="container">
					<p class="pull-right">
						<h3>About</h3>
					</p>
					<p>
						Designed and Developed by CEO Wayne Matthews and CTO Allison Mobley.
					</p>
					<ul class="footer-links">
						<li>
							<a href="http://hometract.blogspot.com">Blog</a>
						</li>
						<li class="muted">
							&middot;
						</li>
						<li>
							<a href="https://github.com/connectwithcontractors/connectwithcontractors.github.com/issues?state=open">Issues</a>
						</li>
					</ul>
				</div>
			</footer>
		</section>
		<div data-spy="affix" class="affix-bottom" data-offset-top="600">
			<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </a>
					<div>
						<a class="brand navbar-fixed-top pull-left" href="#">ConnectWith!Contractors</a>
					</div>
					<div class="nav-collapse collapse">
						<form class="navbar-form pull-right">
							<input class="span2" type="text" placeholder="Email">
							<input class="span2" type="password" placeholder="Password">
							<button type="submit" class="btn">
								Sign in
							</button>
						</form>
						<ul class="nav pull-right">
							<li class="active">
								<a href="#">Home</a>
							</li>
							<li>
								<a href="#about">About</a>
							</li>
							<li>
								<a href="mailto:connectwithcontractors@gmail.com">Contact</a>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		</div>
		<!-- Le javascript
		================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<!--script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script-->
		<script src="assets/js/jquery.js"></script>
		<script src="assets/js/prettify.js"></script>
		<script src="assets/js/bootstrap-transition.js"></script>
		<script src="assets/js/bootstrap-alert.js"></script>
		<script src="assets/js/bootstrap-modal.js"></script>
		<script src="assets/js/bootstrap-dropdown.js"></script>
		<script src="assets/js/bootstrap-tooltip.js"></script>
		<script src="assets/js/bootstrap-popover.js"></script>
		<script src="assets/js/bootstrap-button.js"></script>
		<script src="assets/js/bootstrap-collapse.js"></script>
		<script src="assets/js/bootstrap-carousel.js"></script>
		<script src="assets/js/bootstrap-typeahead.js"></script>
		<script src="assets/js/bootstrap-affix.js"></script>
		<script src="assets/js/application.js"></script>
		<script>
			/*
			 * Hard Inputs: Contractor Name, Contractor Company, Client Name
			 * Auto Inputs: Today's Date
			 * Variable Inputs: Product, Price, Quantity, Total
			 * Buttons: Add Variable Input Line
			 * Outputs: Proposal, Total Materials Cost
			 */
			execute();			
			function execute(){
				var proposalSent = false, addButtonClicked = false, productCount = 0;;
				var controlValues = new Array(productCount,addButtonClicked);
				//alert("productCount: "+controlValues[0]+' addButtonClicked: '+controlValues[1]);
				
				
				AddCompanyLine();
				AddButtons();
				AddTotalCostLine();
				$("#AddNewInputItemButton").attr('href','javascript:AddButtonClicked=true;');
				productCount++;
				alert("productCount: "+controlValues[0]+' addButtonClicked: '+controlValues[1]);
				
				if (proposalSent != true) {
					if (addButtonClicked) {
						controlValues= AddVariableInputLine(productCount, addButtonClicked);
						alert(controlValues);
					}
				}
				//addEventListenersForInputChanges();
				//$('#TotalMaterialsCost').val("$0.00");
				//var totalValue = 0;

				//return { name:this.name, value:this.value };
			}

			function AddVariableInputLine(productCount,addButtonClicked) {
				var pni = "ProductNameInput" + productCount;
				var ppi = "ProductPriceInput" + productCount;
				var pqi = "ProductQuantityInput" + productCount;
				var ptc = "ProductTotalCostOutput" + productCount;
				$("<ul>", {class : "inline", html : 
					$("<div>", { class : "", html : 
						$("<div>", { class : "nav" }).append(
							$("<td>", { class : "", html : "Product Name: "}), 
							$("<td>", {class : "",html : $("<input>", {id : pni})}), 
							$("<td>", {class : "",html : "Unit Price: "}), 
							$("<td>", {class : "",html : $("<input>", {id : ppi})}), 
							$("<td>", {class : "",html : "Quantity: "}), 
							$("<td>", {class : "",html : $("<input>", {id : pqi})}), 
							$("<td>", {class : "",html : "Cost: "}), 
							$("<td>", {class : "",html : $("<input>", {id : ptc})})
						)
					})
				}).appendTo("#inputs")
				addEventListenerForChangesOnGivenInput(ppi, productCount);
				addEventListenerForChangesOnGivenInput(pqi, productCount);
				addEventListenerForChangesOnGivenInput(ptc, productCount);
				productCount++;
				addButtonClicked=false;
				return { productCount:this.productCount, addButtonClicked:this.addButtonClicked };
			}

			function addEventListenerForChangesOnGivenInput(inputID, index) {
				hashedID = "#" + inputID;
				$(hashedID).bind("change paste keyup blur", function() {
					var thisLinesTotalCostID = "#ProductTotalCostOutput" + index;
					var result = '$0.00';
					var thisLinesPriceID = "#ProductPriceInput" + index;
					var thisLinesQuantityID = "#ProductQuantityInput" + index;
					var price = $(thisLinesPriceID).val();
					var quantity = $(thisLinesQuantityID).val();
					if (isNumber(price) && isNumber(quantity)) {
						result = price * quantity;
						//calculateTotalMaterialsCost();
					}
					//if(isNumber($(thisLinesPriceID).val())){
					//alert();
					//}
					$(thisLinesTotalCostID).val(result);
					//calculateTotalMaterialsCost();
				});
			}

			function isNumber(n) {
				return !isNaN(parseFloat(n)) && isFinite(n);
			}

			function calculateTotalMaterialsCost() {

				var count = -1;
				if (productCount == 0) {
					count = 1
				} else {
					count = productCount;
				}
				for (var i = 0; i < count; i++) {
					var subtotalItemID = "#ProductTotalCostOutput" + i;
					var subtotalValue = $(subtotalItemID).val();
					alert(totalValue + " " + subtotalValue);
					totalValue = totalValue + subtotalValue;
				}
				if (isNumber(totalValue))
					;
				$('#TotalMaterialsCost').val(totalValue);
			}
			
			function AddButtons(){
				$("<input>",{id:"sampleInputID"}).prependTo('body');
				var width = $("#sampleInputID").width();
				//width = width/3;
				width = width/2;
				$("#sampleInputID").remove();
				var widthStr = "width:"+width+"px";
				$("<ul>", {class : "inline",html : $("<div>", {class : "", html : $("<div>", {class : "nav"}).append(
							$("<div>", {class : "span3",html :$("<div>", {class : "btn-toolbar",id : "AddNewInputItemButton",html : "Send Proposal",style : widthStr})}).append(
									$("<td>", {class : "",html :$("<a>", {class : "btn btn-success btn-large",id : "AddNewInputItemButton",html : "Send Proposal",style : widthStr})}),
								    $("<td>", {class : "",html :$("<a>", {class : "btn btn-primary btn-large",id : "AddNewInputItemButton",html : "Materials Line++",style : widthStr})})
							)
				)})}).prependTo("#inputs");
				//$("#sampleInputID").class('hide');
			}
			function AddCompanyLine() {
				$("<ul>",{class :"inline",html:$("<div>",{class:"",html:$("<div>", {class : "nav"}).append(
						$("<td>", {class : "span",html : "Company Name: "}),$("<td>", {class : "span",html : $("<input>", {id : "ContractorNameInput"})}),
						$("<td>", {class : "span",html : "Contractor Name: "}), $("<td>", {class : "span",html : $("<input>", {id : "ContractorCompanyInput"})}), 
						$("<td>", {class : "span",html : "Customer Name: "}), $("<td>", {class : "span",html : $("<input>", {id : "CustomerNameInput"})}), 
						$("<td>", {class : "span",html : "Customer E-mail: "}), $("<td>", {class : "span",html : $("<input>", {id : "CustomerEmailInput"})}))})
				}).appendTo("#inputs");
			}
			function AddTotalCostLine() {
				$("<ul>", {class : "inline",html : $("<div>", {
						class : "",html : $("<div>", {class : "nav"}).append(
							$("<td>", {class : "",html : "Total Materials Cost: "}), 
							$("<td>", {class : "",html : $("<input>", {id : "TotalMaterialsCost"
				})}))})}).prependTo("#proposal");
			}
			
		</script>
	</body>
</html>
